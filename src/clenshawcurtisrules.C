#include "clenshawcurtisrules.h"
//nodes and weights for the Clenshaw Curtis quadrature rules
//from https://people.sc.fsu.edu/~jburkardt/datasets/quadrature_rules_clenshaw_curtis/quadrature_rules_clenshaw_curtis.html
#include "sandia_rules.hpp"

using namespace std;
double cc::xxx[65][65];
double cc::www[65][65];

const double cc::xxx9[9]={-1.0000000000000000,
			  -0.9238795325112867,    
			  -0.7071067811865475,    
			  -0.3826834323650897,    
			  0.000000000000000,    
			  0.3826834323650898,    
			  0.7071067811865475,    
			  0.9238795325112867,    
			  1.0000000000000000};
const double cc::www9[9]={0.1587301587301588E-01,
			  0.1462186492160182,    
			  0.2793650793650794,    
			  0.3617178587204897,    
			  0.3936507936507936,    
			  0.3617178587204898,    
			  0.2793650793650794,    
			  0.1462186492160182,    
			  0.1587301587301588E-01};

const double cc::xxx33[33]={-1.0000000000000000,
			    -0.9951847266721968,    
			    -0.9807852804032304,    
			    -0.9569403357322088,    
			    -0.9238795325112867,    
			    -0.8819212643483549,    
			    -0.8314696123025453,    
			    -0.7730104533627370,    
			    -0.7071067811865475,    
			    -0.6343932841636454,    
			    -0.5555702330196020,    
			    -0.4713967368259977,    
			    -0.3826834323650897,    
			    -0.2902846772544622,    
			    -0.1950903220161282,    
			    -0.9801714032956065E-01,
			    0.000000000000000,
			    0.9801714032956077E-01,
			    0.1950903220161283,    
			    0.2902846772544623,    
			    0.3826834323650898,    
			    0.4713967368259978,    
			    0.5555702330196023,    
			    0.6343932841636455,    
			    0.7071067811865475,    
			    0.7730104533627370,    
			    0.8314696123025452,    
			    0.8819212643483550,    
			    0.9238795325112867,    
			    0.9569403357322088,    
			    0.9807852804032304,    
			    0.9951847266721969,    
			    1.0000000000000000};
const double cc::www33[33]={0.9775171065493659E-03,
			    0.9393197962955013E-02,
			    0.1923424513268114E-01,
			    0.2845791667723369E-01,
			    0.3759434191404722E-01,
			    0.4626276283775175E-01,
			    0.5455501630398032E-01,
			    0.6227210954529399E-01,
			    0.6942757563043547E-01,
			    0.7588380044138848E-01,
			    0.8163481765493850E-01,
			    0.8657753844182743E-01,
			    0.9070611286772098E-01,
			    0.9394324443876872E-01,
			    0.9629232594548820E-01,
			    0.9769818820805558E-01,
			    0.9817857778176831E-01,
			    0.9769818820805558E-01,
			    0.9629232594548819E-01,
			    0.9394324443876871E-01,
			    0.9070611286772098E-01,
			    0.8657753844182743E-01,
			    0.8163481765493850E-01,
			    0.7588380044138850E-01,
			    0.6942757563043547E-01,
			    0.6227210954529399E-01,
			    0.5455501630398031E-01,
			    0.4626276283775177E-01,
			    0.3759434191404721E-01,
			    0.2845791667723370E-01,
			    0.1923424513268119E-01,
			    0.9393197962955048E-02,
			    0.9775171065493659E-03};

const double cc::xxx65[65]={-1.0000000000000000,
			    -0.9987954562051724,    
			    -0.9951847266721968,    
			    -0.9891765099647810,    
			    -0.9807852804032304,    
			    -0.9700312531945440,    
			    -0.9569403357322088,    
			    -0.9415440651830207,    
			    -0.9238795325112867,    
			    -0.9039892931234433,    
			    -0.8819212643483549,    
			    -0.8577286100002720,    
			    -0.8314696123025453,    
			    -0.8032075314806448,    
			    -0.7730104533627370,    
			    -0.7409511253549589,    
			    -0.7071067811865475,    
			    -0.6715589548470184,    
			    -0.6343932841636454,    
			    -0.5956993044924334,    
			    -0.5555702330196020,    
			    -0.5141027441932217,    
			    -0.4713967368259977,    
			    -0.4275550934302819,    
			    -0.3826834323650897,    
			    -0.3368898533922199,    
			    -0.2902846772544622,    
			    -0.2429801799032639,    
			    -0.1950903220161282,    
			    -0.1467304744553616,    
			    -0.9801714032956065E-01,
			    -0.4906767432741801E-01,
			    0.000000000000000,    
			    0.4906767432741813E-01,
			    0.9801714032956077E-01,
			    0.1467304744553617,    
			    0.1950903220161283,    
			    0.2429801799032640,    
			    0.2902846772544623,    
			    0.3368898533922201,    
			    0.3826834323650898,    
			    0.4275550934302822,    
			    0.4713967368259978,    
			    0.5141027441932218,    
			    0.5555702330196023,    
			    0.5956993044924335,    
			    0.6343932841636455,    
			    0.6715589548470184,    
			    0.7071067811865475,    
			    0.7409511253549592,    
			    0.7730104533627370,    
			    0.8032075314806448,    
			    0.8314696123025452,    
			    0.8577286100002721,    
			    0.8819212643483550,    
			    0.9039892931234433,    
			    0.9238795325112867,    
			    0.9415440651830208,    
			    0.9569403357322088,    
			    0.9700312531945440,    
			    0.9807852804032304,    
			    0.9891765099647810,    
			    0.9951847266721969,    
			    0.9987954562051724,    
			    1.0000000000000000};
const double cc::www65[65]={0.2442002442002449E-03,
			    0.2351490675311702E-02,
			    0.4831465448790911E-02,
			    0.7192693161736115E-02,
			    0.9582338795283791E-02,
			    0.1192339471421277E-01,
			    0.1425206043235199E-01,
			    0.1653498765728959E-01,
			    0.1878652974179578E-01,
			    0.2098627442973744E-01,
			    0.2314069493435819E-01,
			    0.2523506498175476E-01,
			    0.2727225714146840E-01,
			    0.2924065319746835E-01,
			    0.3114129710406762E-01,
			    0.3296454656997634E-01,
			    0.3471049818092511E-01,
			    0.3637092028663919E-01,
			    0.3794545992128482E-01,
			    0.3942698871295609E-01,
			    0.4081501340035782E-01,
			    0.4210333111141810E-01,
			    0.4329151496169082E-01,
			    0.4437417923925731E-01,
			    0.4535110955166067E-01,
			    0.4621766751092559E-01,
			    0.4697395904661415E-01,
			    0.4761604458525018E-01,
			    0.4814443257251221E-01,
			    0.4855584485714105E-01,
			    0.4885125664306610E-01,
			    0.4902801843102554E-01,
			    0.4908762351494248E-01,
			    0.4902801843102556E-01,
			    0.4885125664306610E-01,
			    0.4855584485714105E-01,
			    0.4814443257251221E-01,
			    0.4761604458525019E-01,
			    0.4697395904661414E-01,
			    0.4621766751092559E-01,
			    0.4535110955166067E-01,
			    0.4437417923925733E-01,
			    0.4329151496169082E-01,
			    0.4210333111141811E-01,
			    0.4081501340035782E-01,
			    0.3942698871295609E-01,
			    0.3794545992128483E-01,
			    0.3637092028663919E-01,
			    0.3471049818092511E-01,
			    0.3296454656997635E-01,
			    0.3114129710406762E-01,
			    0.2924065319746836E-01,
			    0.2727225714146839E-01,
			    0.2523506498175477E-01,
			    0.2314069493435821E-01,
			    0.2098627442973743E-01,
			    0.1878652974179578E-01,
			    0.1653498765728961E-01,
			    0.1425206043235200E-01,
			    0.1192339471421278E-01,
			    0.9582338795283809E-02,
			    0.7192693161736120E-02,
			    0.4831465448790926E-02,
			    0.2351490675311698E-02,
			    0.2442002442002449E-03};

void cc::init()
{
  for (int i = 0; i < 65; i++)
    for (int j = 0; j < 65; j++)
      {
	xxx[i][j] = 0;
	www[i][j] = 0;
      }
  for (int i = 0; i < 65; i++)
    {
      if (i < 9) xxx[9-1][i] = xxx9[i];
      if (i < 33) xxx[33-1][i] = xxx33[i];
      if (i < 65) xxx[65-1][i] = xxx65[i];

      if (i < 9) www[9-1][i] = www9[i];
      if (i < 33) www[33-1][i] = www33[i];
      if (i < 65) www[65-1][i] = www65[i];
    }

  //generation of weights and nodes
  for (int n = 1; n <= 65; n++)
    {
      double *w = new double[n];
      double *x = new double[n];
      webbur::clenshaw_curtis_compute(n, x, w);
      for ( int i = 1; i <= n; i++ )
	{
	  xxx[n-1][i-1] = x[i-1];
	  www[n-1][i-1] = w[i-1];
	}
    }
}
